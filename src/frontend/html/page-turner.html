<!--
SPDX-FileCopyrightText: 2023 sublipri <sublipri@proton.me>
SPDX-License-Identifier: GPL-3.0-only
-->
<!doctype html>
<html>
  <head>
    <title>Kobo Wi-Fi Remote</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
      charset="UTF-8"
    />
    <link href="/styles/main.css" rel="stylesheet" />
    <style>
      .button-container {
        display: flex;
        flex-direction: column;
        height: 100vh;
      }
      .remote-button {
        width: 100vw;
        height: 50vh;
      }

      @media (orientation: landscape) {
        .button-container {
          flex-direction: row;
        }
        .remote-button {
          width: 50vw;
          height: 100vh;
        }
      }
    </style>
  </head>
  <body style="margin: 0; padding: 0">
    <div class="button-container">
      <button
        class="remote-button colored-button"
        id="prev-page"
        title="Previous Page (Shortcut: ArrowLeft or KeyA)"
        style="background-color: #5783db"
        type="button"
      >
        Prev
      </button>
      <button
        class="remote-button colored-button"
        id="next-page"
        title="Next Page (Shortcut: ArrowRight or KeyD)"
        style="background-color: #33b249"
        type="button"
      >
        Next
      </button>
    </div>
    <div id="result-modal" class="modal">
      <div class="modal-content">
        <span id="result-close-modal" class="close">&times;</span>
        <p></p>
      </div>
    </div>
  </body>
  <script>
    next_btn = document.getElementById("next-page");
    prev_btn = document.getElementById("prev-page");
    const close = document.getElementById("result-close-modal");
    next_btn.onclick = async () => {
      await playAction("next-page");
    };
    prev_btn.onclick = async () => {
      await playAction("prev-page");
    };
    close.onclick = function () {
      const modal = document.getElementById("result-modal");
      modal.style.display = "none";
    };

    window.addEventListener(
      "keydown",
      (event) => {
        switch (event.code) {
          case "Right":
          case "ArrowRight":
          case "KeyD":
            next_btn.click();
            break;
          case "Left":
          case "ArrowLeft":
          case "KeyA":
            prev_btn.click();
            break;
          case "Escape":
            close.click();
            break;
        }
      },
      true,
    );

    async function playAction(path_segment) {
      const response = await fetch(`/actions/${path_segment}`);
      if (!response.ok) {
        const result = document.getElementById("result-modal");
        const p = result.querySelector("p");
        p.innerHTML = await response.text();
        result.style.display = "block";
      }
    }
  </script>
  <script src="/js/colored-buttons.js"></script>
</html>
